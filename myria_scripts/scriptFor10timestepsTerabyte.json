{
    "logicalRa": "scriptfor10TimestepsTerabyteDatasetTested",
    "plan": {
        "type": "Sequence",
        "plans": [
           {
                "fragments": [
                    {
                        "workers": [
                            40
                        ],
                        "operators": [
                            {
                                "opType": "DbQueryScan",
                                "opName": "V25",
                                "opId": 1,
                                "schema": {
                                    "columnNames": [
                                        "nowGroup"
                                    ],
                                    "columnTypes": [
                                        "INT_TYPE"
                                    ]
                                },
                                "sql": "SELECT NowGroup from \"public adhoc pickedGroups\""
                            },
                            {
                                "argChild": 1,
                                "opId": 2,
                                "opName": "broadcast",
                                "opType": "BroadcastProducer"
                            }
                        ]
                    },
                    {
                        "operators": [
                            {
                                "argOperatorId": 2,
                                "opName": "receive",
                                "opId": 5,
                                "opType": "BroadcastConsumer"
                            },
                            {
                                "argChild": 5,
                                "argOverwriteTable": true,
                                "opType": "DbInsert",
                                "opName": "V0",
                                "opId": 6,
                                "relationKey": {
                                    "programName": "adhoc",
                                    "relationName": "pickedGroupsB",
                                    "userName": "public"
                                }
                            }
                        ]
                    }
                ],
                "type": "SubQuery"
            },
            {
                "fragments": [
                    {
                        "workers": [
                            2,
                            35,
                            3,
                            4,
                            5,
                            6,
                            7,
                            8,
                            9,
                            10,
                            11,
                            12,
                            13,
                            14,
                            15,
                            16,
                            17,
                            34,
                            20,
                            33,
                            21,
                            22,
                            23,
                            24,
                            25,
                            26,
                            27,
                            28,
                            29,
                            30,
                            31,
                            32
                        ],
                        "operators": [
                            {
                                "opType": "DbQueryScan",
                                "opName": "V25",
                                "opId": 1,
                                "schema": {
                                    "columnNames": [
                                        "nowGroup",
                                        "iOrder",
                                        "mass",
                                        "type"
                                    ],
                                    "columnTypes": [
                                        "INT_TYPE",
                                        "INT_TYPE",
                                        "FLOAT_TYPE",
                                        "STRING_TYPE"
                                    ]
                                },
                                "sql": "SELECT grp as nowGroup, iord as iOrder, mass, type FROM \"public adhoc snapshot1818Hash\" WHERE  type IN ('dark','gas') and grp in (SELECT nowGroup from \"public adhoc pickedGroupsB\")"
                            },
                            {
                                "argChild": 1,
                                "opId": 2,
                                "opType": "CollectProducer"
                            }
                        ]
                    },
                    {
                        "workers": [
                            2
                        ],
                        "operators": [
                            {
                                "argOperatorId": 2,
                                "opId": 3,
                                "opType": "CollectConsumer"
                            },
                            {
                                "argChild": 3,
                                "opName": "broadcast",
                                "opId": 4,
                                "opType": "BroadcastProducer"
                            }
                        ]
                    },
                    {
                        "workers": [
                            2,
                            35,
                            3,
                            4,
                            5,
                            6,
                            7,
                            8,
                            9,
                            10,
                            11,
                            12,
                            13,
                            14,
                            15,
                            16,
                            17,
                            34,
                            20,
                            33,
                            21,
                            22,
                            23,
                            24,
                            25,
                            26,
                            27,
                            28,
                            29,
                            30,
                            31,
                            32
                        ],
                        "operators": [
                            {
                                "argOperatorId": 4,
                                "opName": "receive",
                                "opId": 5,
                                "opType": "BroadcastConsumer"
                            },
                            {
                                "argChild": 5,
                                "argOverwriteTable": true,
                                "opType": "DbInsert",
                                "opName": "V0",
                                "opId": 6,
                                "relationKey": {
                                    "programName": "mergerTreeTerabyte",
                                    "relationName": "broadcastParticlesOfInterest",
                                    "userName": "astro"
                                }
                            }
                        ]
                    }
                ],
                "type": "SubQuery"
            },
            {
                "fragments": [
                    {
                        "workers": [
                            7
                        ],
                        "operators": [
                            {
                                "opType": "DbQueryScan",
                                "opName": "V25",
                                "opId": 1,
                                "schema": {
                                    "columnNames": [
                                        "nowGroup",
                                        "mass"
                                    ],
                                    "columnTypes": [
                                        "INT_TYPE",
                                        "FLOAT_TYPE"
                                    ]
                                },
                                "sql": "SELECT nowGroup as nowGroup, sum(mass) as mass FROM \"astro mergerTreeTerabyte broadcastParticlesOfInterest\"  group by nowGroup"
                            },
                            {
                                "argChild": 1,
                                "argOverwriteTable": true,
                                "opType": "DbInsert",
                                "opName": "V0",
                                "opId": 2,
                                "relationKey": {
                                    "programName": "mergerTreeTerabyte",
                                    "relationName": "haloMass",
                                    "userName": "astro"
                                }
                            }
                        ]
                    }
                ],
                "type": "SubQuery"
            },
            {
                "fragments": [
                    {
                        "workers": [
                            2,
                            35,
                            3,
                            4,
                            5,
                            6,
                            7,
                            8,
                            9,
                            10,
                            11,
                            12,
                            13,
                            14,
                            15,
                            16,
                            17,
                            34,
                            20,
                            33,
                            21,
                            22,
                            23,
                            24,
                            25,
                            26,
                            27,
                            28,
                            29,
                            30,
                            31,
                            32
                        ],
                        "operators": [
                            {
                                "opType": "DbQueryScan",
                                "opName": "Scan",
                                "opId": 1,
                                "schema": {
                                    "columnNames": [
                                        "nowGroup",
                                        "iOrder",
                                        "mass",
                                        "type",
                                        "timestep",
                                        "grp"
                                    ],
                                    "columnTypes": [
                                        "INT_TYPE",
                                        "INT_TYPE",
                                        "FLOAT_TYPE",
                                        "STRING_TYPE",
                                        "INT_TYPE",
                                        "INT_TYPE"
                                    ]
                                },
                                "sql": "SELECT p1.nowGroup, p2.iord as iOrder, p2.mass, p2.type, 2 as timestep, p2.grp FROM \"astro mergerTreeTerabyte broadcastParticlesOfInterest\" p1, \"public adhoc snapshot1745Hash\" p2 WHERE p1.iOrder = p2.iord and p2.grp>-1 and p2.type IN ('dark', 'star') UNION SELECT p1.nowGroup, p3.iord as iOrder, p3.mass, p3.type, 3 as timestep, p3.grp FROM \"astro mergerTreeTerabyte broadcastParticlesOfInterest\" p1, \"public adhoc snapshot1648Hash\" p3 WHERE p1.iOrder = p3.iord and p3.grp>-1 and p3.type IN ('dark', 'star') UNION SELECT p1.nowGroup, p4.iord as iOrder, p4.mass, p4.type, 4 as timestep, p4.grp FROM \"astro mergerTreeTerabyte broadcastParticlesOfInterest\" p1, \"public adhoc snapshot1556Hash\" p4 WHERE p1.iOrder = p4.iord and p4.grp>-1 and p4.type IN ('dark', 'star') UNION SELECT p1.nowGroup, p5.iord as iOrder, p5.mass, p5.type, 5 as timestep, p5.grp FROM \"astro mergerTreeTerabyte broadcastParticlesOfInterest\" p1, \"public adhoc snapshot1536Hash\" p5 WHERE p1.iOrder = p5.iord and p5.grp>-1 and p5.type IN ('dark', 'star')"
                            },
                            {
                                "argChild": 1,
                                "argOverwriteTable": true,
                                "opName": "Insert",
                                "opId": 2,
                                "opType": "DbInsert",
                                "relationKey": {
                                    "programName": "mergerTreeTerabyte",
                                    "relationName": "allTimestepsPOI",
                                    "userName": "astro"
                                }
                            }
                        ]
                    }
                ],
                "type": "SubQuery"
            },
            {
                "fragments": [
                    {
                        "workers": [
                            2
                        ],
                        "operators": [
                            {
                                "opName": "MyriaScan(jortiz:testAstro:broadcastTest)",
                                "opId": 0,
                                "opType": "TableScan",
                                "relationKey": {
                                    "programName": "mergerTreeTerabyte",
                                    "userName": "astro",
                                    "relationName": "broadcastParticlesOfInterest"
                                }
                            },
                            {
                                "argChild": 0,
                                "opId": 189,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "index": 1,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            2,
                            35,
                            3,
                            4,
                            5,
                            6,
                            7,
                            8,
                            9,
                            10,
                            11,
                            12,
                            13,
                            14,
                            15,
                            16,
                            17,
                            34,
                            20,
                            33,
                            21,
                            22,
                            23,
                            24,
                            25,
                            26,
                            27,
                            28,
                            29,
                            30,
                            31,
                            32
                        ],
                        "operators": [
                            {
                                "argOperatorId": 189,
                                "opId": 190,
                                "opType": "ShuffleConsumer"
                            },
                            {
                                "argChild": 190,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "columnIdx": 0,
                                            "type": "VARIABLE"
                                        }
                                    },
                                    {
                                        "outputName": "iOrder",
                                        "rootExpressionOperator": {
                                            "columnIdx": 1,
                                            "type": "VARIABLE"
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "columnIdx": 2,
                                            "type": "VARIABLE"
                                        }
                                    },
                                    {
                                        "outputName": "type",
                                        "rootExpressionOperator": {
                                            "columnIdx": 3,
                                            "type": "VARIABLE"
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "valueType": "INT_TYPE",
                                            "value": "1",
                                            "type": "CONSTANT"
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "columnIdx": 0,
                                            "type": "VARIABLE"
                                        }
                                    }
                                ],
                                "opName": "MyriaApply(nowGroup=$0,iOrder=$1,mass=$2,type=$3,timestep=1,grp=$0)",
                                "opId": 1,
                                "opType": "Apply"
                            },
                            {
                                "opName": "MyriaScan(jortiz:testAstro:allTimestepsTest)",
                                "opId": 2,
                                "opType": "TableScan",
                                "relationKey": {
                                    "programName": "mergerTreeTerabyte",
                                    "userName": "astro",
                                    "relationName": "allTimestepsPOI"
                                }
                            },
                            {
                                "opName": "MyriaUnionAll",
                                "opId": 3,
                                "opType": "UnionAll",
                                "argChildren": [
                                    2,
                                    1
                                ]
                            },
                            {
                                "argChild": 3,
                                "opId": 155,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "index": 1,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "argOperatorId": 155,
                                "opId": 156,
                                "opType": "ShuffleConsumer"
                            },
                            {
                                "opName": "MyriaStore(public:adhoc:allTimestepsUnion)",
                                "relationKey": {
                                    "programName": "mergerTreeTerabyte",
                                    "userName": "astro",
                                    "relationName": "allTimestepsUnion"
                                },
                                "argChild": 156,
                                "argOverwriteTable": true,
                                "opType": "DbInsert",
                                "opId": 4
                            }
                        ]
                    }
                ],
                "type": "SubQuery"
            },

            {
                "fragments": [
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "opId": 0,
                                "argOperatorId": 1
                            },
                            {
                                "argAggOperators": [
                                    [
                                        "AGG_OP_SUM"
                                    ],
                                    [
                                        "AGG_OP_SUM"
                                    ],
                                    [
                                        "AGG_OP_SUM"
                                    ]
                                ],
                                "opType": "MultiGroupByAggregate",
                                "argChild": 0,
                                "argGroupFields": [
                                    0,
                                    1,
                                    2,
                                    3
                                ],
                                "argAggFields": [
                                    4,
                                    5,
                                    6
                                ],
                                "opName": "MyriaGroupBy($0,$1,$2,$3; SUM($4),SUM($5),SUM($6))",
                                "opId": 2
                            },
                            {
                                "opId": 3,
                                "argPredicate": {
                                    "rootExpressionOperator": {
                                        "right": {
                                            "right": {
                                                "valueType": "INT_TYPE",
                                                "type": "CONSTANT",
                                                "value": "100"
                                            },
                                            "type": "GT",
                                            "left": {
                                                "type": "VARIABLE",
                                                "columnIdx": 5
                                            }
                                        },
                                        "type": "AND",
                                        "left": {
                                            "right": {
                                                "valueType": "INT_TYPE",
                                                "type": "CONSTANT",
                                                "value": "64"
                                            },
                                            "type": "GT",
                                            "left": {
                                                "type": "VARIABLE",
                                                "columnIdx": 6
                                            }
                                        }
                                    }
                                },
                                "opType": "Filter",
                                "opName": "MyriaSelect((($6 > 64) and ($5 > 100)))",
                                "argChild": 2
                            },
                            {
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "currentHalo",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "nextHalo",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "sharedParticleCount",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    },
                                    {
                                        "outputName": "sharedDark",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 6
                                        }
                                    }
                                ],
                                "opName": "MyriaApply(nowGroup=$0,timestep=$1,currentHalo=$2,nextHalo=$3,massSum=$4,sharedParticleCount=$5,sharedDark=$6)",
                                "opType": "Apply",
                                "opId": 4,
                                "argChild": 3
                            },
                            {
                                "opId": 66,
                                "opName": "MyriaShuffleProducer(h($0))",
                                "argChild": 4,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "index": 0,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opId": 67,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 66
                            },
                            {
                                "opId": 69,
                                "opType": "InMemoryOrderBy",
                                "opName": "InMemSort(edges)",
                                "argChild": 67,
                                "argSortColumns": [
                                    0,
                                    1,
                                    3,
                                    4
                                ],
                                "argAscending": [
                                    true,
                                    true,
                                    true,
                                    false
                                ]
                            },
                            {
                                "opType": "DbInsert",
                                "argChild": 69,
                                "opName": "MyriaStore(jortiz:testAstro:edgesPreFilterTest)",
                                "argOverwriteTable": true,
                                "opId": 70,
                                "relationKey": {
                                    "userName": "astro",
                                    "relationName": "edgesPreFilter",
                                    "programName": "mergerTreeTerabyte"
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "opId": 6,
                                "argOperatorId": 7
                            },
                            {
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "opId": 8,
                                "argOperatorId": 9
                            },
                            {
                                "argColumnNames": [
                                    "nowGroup",
                                    "iOrder",
                                    "mass",
                                    "type",
                                    "timestep",
                                    "grp",
                                    "haloID",
                                    "nowGroup1",
                                    "iOrder1",
                                    "mass1",
                                    "type1",
                                    "timestep1",
                                    "grp1",
                                    "haloID1"
                                ],
                                "argChild2": "6",
                                "argChild1": "8",
                                "opType": "SymmetricHashJoin",
                                "opId": 10,
                                "opName": "MyriaSymmetricHashJoin(($1 = $8); [$0, $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13])",
                                "argSelect2": [
                                    0,
                                    1,
                                    2,
                                    3,
                                    4,
                                    5,
                                    6
                                ],
                                "argColumns1": [
                                    1
                                ],
                                "argColumns2": [
                                    1
                                ],
                                "argSelect1": [
                                    0,
                                    1,
                                    2,
                                    3,
                                    4,
                                    5,
                                    6
                                ]
                            },
                            {
                                "opId": 11,
                                "argPredicate": {
                                    "rootExpressionOperator": {
                                        "right": {
                                            "type": "VARIABLE",
                                            "columnIdx": 11
                                        },
                                        "type": "EQ",
                                        "left": {
                                            "right": {
                                                "valueType": "INT_TYPE",
                                                "type": "CONSTANT",
                                                "value": "1"
                                            },
                                            "type": "PLUS",
                                            "left": {
                                                "type": "VARIABLE",
                                                "columnIdx": 4
                                            }
                                        }
                                    }
                                },
                                "opType": "Filter",
                                "opName": "MyriaSelect((($4 + 1) = $11))",
                                "argChild": 10
                            },
                            {
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "haloID",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 6
                                        }
                                    },
                                    {
                                        "outputName": "iOrder1",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 8
                                        }
                                    },
                                    {
                                        "outputName": "mass1",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 9
                                        }
                                    },
                                    {
                                        "outputName": "haloID1",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 13
                                        }
                                    },
                                    {
                                        "outputName": "_COLUMN6_",
                                        "rootExpressionOperator": {
                                            "type": "CONDITION",
                                            "children": [
                                                {
                                                    "right": {
                                                        "valueType": "STRING_TYPE",
                                                        "type": "CONSTANT",
                                                        "value": "dark"
                                                    },
                                                    "type": "EQ",
                                                    "left": {
                                                        "type": "VARIABLE",
                                                        "columnIdx": 10
                                                    }
                                                },
                                                {
                                                    "valueType": "INT_TYPE",
                                                    "type": "CONSTANT",
                                                    "value": "1"
                                                },
                                                {
                                                    "valueType": "INT_TYPE",
                                                    "type": "CONSTANT",
                                                    "value": "0"
                                                }
                                            ]
                                        }
                                    }
                                ],
                                "opName": "MyriaApply(nowGroup=$0,timestep=$4,haloID=$6,iOrder1=$8,mass1=$9,haloID1=$13,_COLUMN6_=CASE(WHEN ($10 = \"dark\") THEN 1 ELSE 0))",
                                "opType": "Apply",
                                "opId": 12,
                                "argChild": 11
                            },
                            {
                                "argAggOperators": [
                                    [
                                        "AGG_OP_SUM"
                                    ],
                                    [
                                        "AGG_OP_COUNT"
                                    ],
                                    [
                                        "AGG_OP_SUM"
                                    ]
                                ],
                                "opType": "MultiGroupByAggregate",
                                "argChild": 12,
                                "argGroupFields": [
                                    0,
                                    1,
                                    2,
                                    5
                                ],
                                "argAggFields": [
                                    4,
                                    3,
                                    6
                                ],
                                "opName": "MyriaGroupBy($0,$1,$2,$5; SUM($4),COUNT($3),SUM($6))",
                                "opId": 13
                            },
                            {
                                "opName": "MyriaShuffleProducer(h($0,$1,$2,$3))",
                                "opType": "ShuffleProducer",
                                "opId": 1,
                                "argChild": 13,
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        0,
                                        1,
                                        2,
                                        3
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "relationKey": {
                                    "userName": "astro",
                                    "relationName": "allTimestepsUnion",
                                    "programName": "mergerTreeTerabyte"
                                },
                                "opType": "TableScan",
                                "opName": "MyriaScan(astro:mergerTreeTerabyte:allTimestepsUnion)",
                                "opId": 14
                            },
                            {
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "iOrder",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "type",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    },
                                    {
                                        "outputName": "haloID",
                                        "rootExpressionOperator": {
                                            "right": {
                                                "type": "VARIABLE",
                                                "columnIdx": 5
                                            },
                                            "type": "PLUS",
                                            "left": {
                                                "right": {
                                                    "valueType": "INT_TYPE",
                                                    "type": "CONSTANT",
                                                    "value": "10000000"
                                                },
                                                "type": "TIMES",
                                                "left": {
                                                    "right": {
                                                        "type": "VARIABLE",
                                                        "columnIdx": 4
                                                    },
                                                    "type": "PLUS",
                                                    "left": {
                                                        "valueType": "INT_TYPE",
                                                        "type": "CONSTANT",
                                                        "value": "100"
                                                    }
                                                }
                                            }
                                        }
                                    }
                                ],
                                "opName": "MyriaApply(nowGroup=nowGroup,iOrder=iOrder,mass=mass,type=type,timestep=timestep,grp=grp,haloID=(((100 + timestep) * 1000) + grp))",
                                "opType": "Apply",
                                "opId": 15,
                                "argChild": 14
                            },
                            {
                                "opName": "MyriaShuffleProducer(h($1))",
                                "opType": "ShuffleProducer",
                                "opId": 9,
                                "argChild": 15,
                                "argPf": {
                                    "index": 1,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "relationKey": {
                                    "userName": "astro",
                                    "relationName": "allTimestepsUnion",
                                    "programName": "mergerTreeTerabyte"
                                },
                                "opType": "TableScan",
                                "opName": "MyriaScan(astro:mergerTreeTerabyte:allTimestepsUnion)",
                                "opId": 16
                            },
                            {
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "iOrder",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "type",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    },
                                    {
                                        "outputName": "haloID",
                                        "rootExpressionOperator": {
                                            "right": {
                                                "type": "VARIABLE",
                                                "columnIdx": 5
                                            },
                                            "type": "PLUS",
                                            "left": {
                                                "right": {
                                                    "valueType": "INT_TYPE",
                                                    "type": "CONSTANT",
                                                    "value": "10000000"
                                                },
                                                "type": "TIMES",
                                                "left": {
                                                    "right": {
                                                        "type": "VARIABLE",
                                                        "columnIdx": 4
                                                    },
                                                    "type": "PLUS",
                                                    "left": {
                                                        "valueType": "INT_TYPE",
                                                        "type": "CONSTANT",
                                                        "value": "100"
                                                    }
                                                }
                                            }
                                        }
                                    }
                                ],
                                "opName": "MyriaApply(nowGroup=nowGroup,iOrder=iOrder,mass=mass,type=type,timestep=timestep,grp=grp,haloID=(((100 + timestep) * 1000) + grp))",
                                "opType": "Apply",
                                "opId": 17,
                                "argChild": 16
                            },
                            {
                                "opName": "MyriaShuffleProducer(h($1))",
                                "opType": "ShuffleProducer",
                                "opId": 7,
                                "argChild": 17,
                                "argPf": {
                                    "index": 1,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    }
                ],
                "type": "SubQuery"
            },







            {
                "fragments": [
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opId": 0,
                                "relationKey": {
                                    "relationName": "edgesPreFilter",
                                    "programName": "mergerTreeTerabyte",
                                    "userName": "astro"
                                },
                                "opName": "MyriaScan(astro:mergerTreeTerabyte:edgesPreFilter)",
                                "opType": "TableScan"
                            },
                            {
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "currentHalo",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "nextHalo",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "sharedParticleCount",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "nextHaloOrder",
                                        "rootExpressionOperator": {
                                            "type": "STATE",
                                            "columnIdx": 1
                                        }
                                    }
                                ],
                                "updaterExpressions": [
                                    {
                                        "outputName": "_grp__73",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "_rank__74",
                                        "rootExpressionOperator": {
                                            "type": "CONDITION",
                                            "children": [
                                                {
                                                    "type": "EQ",
                                                    "left": {
                                                        "type": "VARIABLE",
                                                        "columnIdx": 3
                                                    },
                                                    "right": {
                                                        "type": "STATE",
                                                        "columnIdx": 0
                                                    }
                                                },
                                                {
                                                    "type": "PLUS",
                                                    "left": {
                                                        "type": "STATE",
                                                        "columnIdx": 1
                                                    },
                                                    "right": {
                                                        "type": "CONSTANT",
                                                        "value": "1",
                                                        "valueType": "INT_TYPE"
                                                    }
                                                },
                                                {
                                                    "type": "CONSTANT",
                                                    "value": "1",
                                                    "valueType": "INT_TYPE"
                                                }
                                            ]
                                        }
                                    }
                                ],
                                "initializerExpressions": [
                                    {
                                        "outputName": "_grp__73",
                                        "rootExpressionOperator": {
                                            "type": "TIMES",
                                            "left": {
                                                "type": "CONSTANT",
                                                "value": "-1",
                                                "valueType": "INT_TYPE"
                                            },
                                            "right": {
                                                "type": "CONSTANT",
                                                "value": "1",
                                                "valueType": "INT_TYPE"
                                            }
                                        }
                                    },
                                    {
                                        "outputName": "_rank__74",
                                        "rootExpressionOperator": {
                                            "type": "CONSTANT",
                                            "value": "0",
                                            "valueType": "INT_TYPE"
                                        }
                                    }
                                ],
                                "opId": 1,
                                "argChild": 0,
                                "opName": "MyriaStatefulApply(nowGroup=$0,timestep=$1,currentHalo=$2,nextHalo=$3,sharedParticleCount=$4,nextHaloOrder=_rank__74)",
                                "opType": "StatefulApply"
                            },
                            {
                                "opId": 2,
                                "opName": "MyriaSelect(($5 = 1))",
                                "argChild": 1,
                                "opType": "Filter",
                                "argPredicate": {
                                    "rootExpressionOperator": {
                                        "type": "EQ",
                                        "left": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        },
                                        "right": {
                                            "type": "CONSTANT",
                                            "value": "1",
                                            "valueType": "INT_TYPE"
                                        }
                                    }
                                }
                            },
                            {
                                "opId": 3,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "currentHalo",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "nextHalo",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "sharedParticleCount",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    }
                                ],
                                "argChild": 2,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep=$1,currentHalo=$2,nextHalo=$3,sharedParticleCount=$4)"
                            },
                            {
                                "relationKey": {
                                    "relationName": "edgesSplit",
                                    "programName": "mergerTreeTerabyte",
                                    "userName": "astro"
                                },
                                "opId": 4,
                                "argChild": 3,
                                "argOverwriteTable": true,
                                "opName": "MyriaStore(astro:astroTest:edgesSplit)",
                                "opType": "DbInsert"
                            }
                        ]
                    }
                ],
                "type": "SubQuery"
            },










            {
                "type": "SubQuery",
                "fragments": [
                    {
                          "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opType": "TableScan",
                                "opId": 0,
                                "relationKey": {
                                    "programName": "mergerTreeTerabyte",
                                    "userName": "astro",
                                    "relationName": "edgesSplit"
                                },
                                "opName": "MyriaScan(astro:astroTest:edgesSplit)"
                            },
                            {
                                "opType": "TempInsert",
                                "opId": 1,
                                "argOverwriteTable": true,
                                "opName": "StoreTemp(edgesSplit)",
                                "table": "edgesSplit",
                                "argChild": 0
                            }
                        ]
                    }
                ]
            },
            {
                "type": "SubQuery",
                "fragments": [
                    {
                          "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opType": "TempTableScan",
                                "table": "edgesSplit",
                                "opName": "MyriaScanTemp(edgesSplit,[(u'nowGroup', 'LONG_TYPE'), (u'timestep', 'LONG_TYPE'), (u'currentHalo', 'LONG_TYPE'), (u'nextHalo', 'LONG_TYPE'), (u'sharedParticleCount', 'LONG_TYPE')])",
                                "opId": 0
                            },
                            {
                                "opType": "Filter",
                                "argPredicate": {
                                    "rootExpressionOperator": {
                                        "right": {
                                            "value": "1",
                                            "type": "CONSTANT",
                                            "valueType": "INT_TYPE"
                                        },
                                        "type": "EQ",
                                        "left": {
                                            "columnIdx": 1,
                                            "type": "VARIABLE"
                                        }
                                    }
                                },
                                "opId": 1,
                                "argChild": 0,
                                "opName": "MyriaSelect(($1 = 1))"
                            },
                            {
                                "opType": "TempInsert",
                                "opId": 2,
                                "argOverwriteTable": true,
                                "opName": "StoreTemp(edgesNew)",
                                "table": "edgesNew",
                                "argChild": 1
                            }
                        ]
                    }
                ]
            },
            {
                "type": "SubQuery",
                "fragments": [
                    {
                          "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opType": "Singleton",
                                "opId": 0,
                                "opName": "SingletonRelation"
                            },
                            {
                                "opType": "Apply",
                                "opId": 1,
                                "emitExpressions": [
                                    {
                                        "rootExpressionOperator": {
                                            "value": "1",
                                            "type": "CONSTANT",
                                            "valueType": "INT_TYPE"
                                        },
                                        "outputName": "i"
                                    }
                                ],
                                "argChild": 0,
                                "opName": "MyriaApply(i=1)"
                            },
                            {
                                "opType": "TempInsert",
                                "opId": 2,
                                "argOverwriteTable": true,
                                "opName": "StoreTemp(I)",
                                "table": "I",
                                "argChild": 1
                            }
                        ]
                    }
                ]
            },
            {
                "condition": "__dowhile_4423978064_condition",
                "type": "DoWhile",
                "body": [
                    {
                        "type": "SubQuery",
                        "fragments": [
                            {
                           "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                                "operators": [
                                    {
                                        "opType": "TempTableScan",
                                        "table": "edgesNew",
                                        "opName": "MyriaScanTemp(edgesNew,[(u'nowGroup', 'LONG_TYPE'), (u'timestep', 'LONG_TYPE'), (u'currentHalo', 'LONG_TYPE'), (u'nextHalo', 'LONG_TYPE'), (u'sharedParticleCount', 'LONG_TYPE')])",
                                        "opId": 0
                                    },
                                    {
                                        "opType": "ShuffleConsumer",
                                        "opId": 1,
                                        "argOperatorId": 2,
                                        "opName": "MyriaShuffleConsumer"
                                    },
                                    {
                                        "opType": "ShuffleConsumer",
                                        "opId": 3,
                                        "argOperatorId": 4,
                                        "opName": "MyriaShuffleConsumer"
                                    },
                                    {
                                        "opType": "SymmetricHashJoin",
                                        "argColumns1": [
                                            1
                                        ],
                                        "argColumnNames": [
                                            "nowGroup",
                                            "timestep",
                                            "currentHalo",
                                            "nextHalo",
                                            "sharedParticleCount",
                                            "nowGroup1",
                                            "timestep1",
                                            "currentHalo1",
                                            "nextHalo1",
                                            "sharedParticleCount1",
                                            "i"
                                        ],
                                        "argChild2": "1",
                                        "argColumns2": [
                                            0
                                        ],
                                        "argChild1": "3",
                                        "opId": 5,
                                        "argSelect1": [
                                            0,
                                            1,
                                            2,
                                            3,
                                            4,
                                            5,
                                            6,
                                            7,
                                            8,
                                            9
                                        ],
                                        "argSelect2": [
                                            0
                                        ],
                                        "opName": "MyriaSymmetricHashJoin(($1 = $10); [$0, $1, $2, $3, $4, $5, $6, $7, $8, $9, $10])"
                                    },
                                    {
                                        "opType": "Filter",
                                        "argPredicate": {
                                            "rootExpressionOperator": {
                                                "right": {
                                                    "right": {
                                                        "value": "1",
                                                        "type": "CONSTANT",
                                                        "valueType": "INT_TYPE"
                                                    },
                                                    "type": "PLUS",
                                                    "left": {
                                                        "columnIdx": 10,
                                                        "type": "VARIABLE"
                                                    }
                                                },
                                                "type": "EQ",
                                                "left": {
                                                    "columnIdx": 6,
                                                    "type": "VARIABLE"
                                                }
                                            }
                                        },
                                        "opId": 6,
                                        "argChild": 5,
                                        "opName": "MyriaSelect(($6 = ($10 + 1)))"
                                    },
                                    {
                                        "opType": "Apply",
                                        "opId": 7,
                                        "emitExpressions": [
                                            {
                                                "rootExpressionOperator": {
                                                    "columnIdx": 5,
                                                    "type": "VARIABLE"
                                                },
                                                "outputName": "nowGroup"
                                            },
                                            {
                                                "rootExpressionOperator": {
                                                    "columnIdx": 6,
                                                    "type": "VARIABLE"
                                                },
                                                "outputName": "timestep"
                                            },
                                            {
                                                "rootExpressionOperator": {
                                                    "columnIdx": 7,
                                                    "type": "VARIABLE"
                                                },
                                                "outputName": "currentHalo"
                                            },
                                            {
                                                "rootExpressionOperator": {
                                                    "columnIdx": 8,
                                                    "type": "VARIABLE"
                                                },
                                                "outputName": "nextHalo"
                                            },
                                            {
                                                "rootExpressionOperator": {
                                                    "columnIdx": 9,
                                                    "type": "VARIABLE"
                                                },
                                                "outputName": "sharedParticleCount"
                                            }
                                        ],
                                        "argChild": 6,
                                        "opName": "MyriaApply(nowGroup=$5,timestep=$6,currentHalo=$7,nextHalo=$8,sharedParticleCount=$9)"
                                    },
                                    {
                                        "opType": "UnionAll",
                                        "opId": 8,
                                        "argChildren": [
                                            7,
                                            0
                                        ],
                                        "opName": "MyriaUnionAll"
                                    },
                                    {
                                        "opType": "TempInsert",
                                        "opId": 9,
                                        "argOverwriteTable": true,
                                        "opName": "StoreTemp(edgesNew)",
                                        "table": "edgesNew",
                                        "argChild": 8
                                    }
                                ]
                            },
                            {
                                "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                                "operators": [
                                    {
                                        "opType": "ShuffleConsumer",
                                        "opId": 10,
                                        "argOperatorId": 11,
                                        "opName": "MyriaShuffleConsumer"
                                    },
                                    {
                                        "opType": "ShuffleConsumer",
                                        "opId": 12,
                                        "argOperatorId": 13,
                                        "opName": "MyriaShuffleConsumer"
                                    },
                                    {
                                        "opType": "SymmetricHashJoin",
                                        "argColumns1": [
                                            0,
                                            3
                                        ],
                                        "argColumnNames": [
                                            "nowGroup",
                                            "timestep",
                                            "currentHalo",
                                            "nextHalo",
                                            "sharedParticleCount",
                                            "nowGroup1",
                                            "timestep1",
                                            "currentHalo1",
                                            "nextHalo1",
                                            "sharedParticleCount1"
                                        ],
                                        "argChild2": "10",
                                        "argColumns2": [
                                            0,
                                            2
                                        ],
                                        "argChild1": "12",
                                        "opId": 14,
                                        "argSelect1": [
                                            0,
                                            1,
                                            2,
                                            3,
                                            4
                                        ],
                                        "argSelect2": [
                                            0,
                                            1,
                                            2,
                                            3,
                                            4
                                        ],
                                        "opName": "MyriaSymmetricHashJoin((($0 = $5) and ($3 = $7)); [$0, $1, $2, $3, $4, $5, $6, $7, $8, $9])"
                                    },
                                    {
                                        "opType": "ShuffleProducer",
                                        "opId": 4,
                                        "argChild": 14,
                                        "argPf": {
                                            "type": "SingleFieldHash",
                                            "index": 1
                                        },
                                        "opName": "MyriaShuffleProducer(h($1))"
                                    }
                                ]
                            },
                            {
                                 "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                                "operators": [
                                    {
                                        "opType": "TempTableScan",
                                        "table": "I",
                                        "opName": "MyriaScanTemp(I,[(u'i', 'LONG_TYPE')])",
                                        "opId": 15
                                    },
                                    {
                                        "opType": "ShuffleProducer",
                                        "opId": 2,
                                        "argChild": 15,
                                        "argPf": {
                                            "type": "SingleFieldHash",
                                            "index": 0
                                        },
                                        "opName": "MyriaShuffleProducer(h($0))"
                                    }
                                ]
                            },
                            {
                                "operators": [
                                    {
                                        "opType": "TempTableScan",
                                        "table": "edgesNew",
                                        "opName": "MyriaScanTemp(edgesNew,[(u'nowGroup', 'LONG_TYPE'), (u'timestep', 'LONG_TYPE'), (u'currentHalo', 'LONG_TYPE'), (u'nextHalo', 'LONG_TYPE'), (u'sharedParticleCount', 'LONG_TYPE')])",
                                        "opId": 16
                                    },
                                    {
                                        "opType": "ShuffleProducer",
                                        "opId": 13,
                                        "argChild": 16,
                                        "argPf": {
                                            "type": "MultiFieldHash",
                                            "indexes": [
                                                0,
                                                3
                                            ]
                                        },
                                        "opName": "MyriaShuffleProducer(h($0,$3))"
                                    }
                                ]
                            },
                            {
                                  "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                                "operators": [
                                    {
                                        "opType": "TempTableScan",
                                        "table": "edgesSplit",
                                        "opName": "MyriaScanTemp(edgesSplit,[(u'nowGroup', 'LONG_TYPE'), (u'timestep', 'LONG_TYPE'), (u'currentHalo', 'LONG_TYPE'), (u'nextHalo', 'LONG_TYPE'), (u'sharedParticleCount', 'LONG_TYPE')])",
                                        "opId": 17
                                    },
                                    {
                                        "opType": "ShuffleProducer",
                                        "opId": 11,
                                        "argChild": 17,
                                        "argPf": {
                                            "type": "MultiFieldHash",
                                            "indexes": [
                                                0,
                                                2
                                            ]
                                        },
                                        "opName": "MyriaShuffleProducer(h($0,$2))"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "type": "SubQuery",
                        "fragments": [
                            {
                                "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                                "operators": [
                                    {
                                        "opType": "TempTableScan",
                                        "table": "I",
                                        "opName": "MyriaScanTemp(I,[(u'i', 'LONG_TYPE')])",
                                        "opId": 0
                                    },
                                    {
                                        "opType": "Apply",
                                        "opId": 1,
                                        "emitExpressions": [
                                            {
                                                "rootExpressionOperator": {
                                                    "right": {
                                                        "value": "1",
                                                        "type": "CONSTANT",
                                                        "valueType": "INT_TYPE"
                                                    },
                                                    "type": "PLUS",
                                                    "left": {
                                                        "columnIdx": 0,
                                                        "type": "VARIABLE"
                                                    }
                                                },
                                                "outputName": "i"
                                            }
                                        ],
                                        "argChild": 0,
                                        "opName": "MyriaApply(i=(i + 1))"
                                    },
                                    {
                                        "opType": "TempInsert",
                                        "opId": 2,
                                        "argOverwriteTable": true,
                                        "opName": "StoreTemp(I)",
                                        "table": "I",
                                        "argChild": 1
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "type": "SubQuery",
                        "fragments": [
                            {
                                "operators": [
                                    {
                                        "opType": "CollectConsumer",
                                        "opId": 0,
                                        "argOperatorId": 1,
                                        "opName": "MyriaCollectConsumer"
                                    },
                                    {
                                        "opType": "Aggregate",
                                        "opId": 2,
                                        "argAggFields": [
                                            0
                                        ],
                                        "opName": "MyriaGroupBy(; MIN($0))",
                                        "argAggOperators": [
                                            [
                                                "AGG_OP_MIN"
                                            ]
                                        ],
                                        "argChild": 0
                                    },
                                    {
                                        "opType": "Apply",
                                        "opId": 3,
                                        "emitExpressions": [
                                            {
                                                "rootExpressionOperator": {
                                                    "right": {
                                                        "value": "10",
                                                        "type": "CONSTANT",
                                                        "valueType": "INT_TYPE"
                                                    },
                                                    "type": "LTEQ",
                                                    "left": {
                                                        "columnIdx": 0,
                                                        "type": "VARIABLE"
                                                    }
                                                },
                                                "outputName": "_COLUMN0_"
                                            }
                                        ],
                                        "argChild": 2,
                                        "opName": "MyriaApply(_COLUMN0_=($0 <= 10))"
                                    },
                                    {
                                        "opType": "TempInsert",
                                        "opId": 4,
                                        "argOverwriteTable": true,
                                        "opName": "StoreTemp(__dowhile_4423978064_condition)",
                                        "table": "__dowhile_4423978064_condition",
                                        "argChild": 3
                                    }
                                ]
                            },
                            {
                                 "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                                "operators": [
                                    {
                                        "opType": "TempTableScan",
                                        "table": "I",
                                        "opName": "MyriaScanTemp(I,[(u'i', 'LONG_TYPE')])",
                                        "opId": 5
                                    },
                                    {
                                        "opType": "Aggregate",
                                        "opId": 6,
                                        "argAggFields": [
                                            0
                                        ],
                                        "opName": "MyriaGroupBy(; MIN($0))",
                                        "argAggOperators": [
                                            [
                                                "AGG_OP_MIN"
                                            ]
                                        ],
                                        "argChild": 5
                                    },
                                    {
                                        "opType": "CollectProducer",
                                        "opId": 1,
                                        "argChild": 6,
                                        "opName": "MyriaCollectProducer(@None)"
                                    }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                "type": "SubQuery",
                "fragments": [
                    {
                          "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opType": "TempTableScan",
                                "table": "edgesNew",
                                "opName": "MyriaScanTemp(edgesNew,[(u'nowGroup', 'LONG_TYPE'), (u'timestep', 'LONG_TYPE'), (u'currentHalo', 'LONG_TYPE'), (u'nextHalo', 'LONG_TYPE'), (u'sharedParticleCount', 'LONG_TYPE')])",
                                "opId": 0
                            },
                            {
                                "opType": "DbInsert",
                                "argOverwriteTable": true,
                                "opId": 1,
                                "opName": "MyriaStore(astro:astroTest:edgesChainFinal)",
                                "relationKey": {
                                    "programName": "mergerTreeTerabyte",
                                    "userName": "astro",
                                    "relationName": "edgesChainFinal"
                                },
                                "argChild": 0
                            }
                        ]
                    }
                ]
            },
            {
                "fragments": [
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "opId": 0,
                                "argOperatorId": 1
                            },
                            {
                                "opName": "MyriaDupElim",
                                "opType": "DupElim",
                                "opId": 2,
                                "argChild": 0
                            },
                            {
                                "opType": "DbInsert",
                                "argChild": 2,
                                "opName": "MyriaStore(public:adhoc:DistinctFinalChain)",
                                "argOverwriteTable": true,
                                "opId": 3,
                                "relationKey": {
                                    "userName": "astro",
                                    "relationName": "DistinctFinalChain",
                                    "programName": "mergerTreeTerabyte"
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "relationKey": {
                                    "userName": "astro",
                                    "relationName": "edgesChainFinal",
                                    "programName": "mergerTreeTerabyte"
                                },
                                "opType": "TableScan",
                                "opName": "MyriaScan(astro:mergerTreeCosmo50:edgesChainFinal)",
                                "opId": 4
                            },
                            {
                                "opName": "MyriaShuffleProducer(h($0,$1,$2,$3,$4))",
                                "opType": "ShuffleProducer",
                                "opId": 1,
                                "argChild": 4,
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        0,
                                        1,
                                        2,
                                        3,
                                        4
                                    ]
                                }
                            }
                        ]
                    }
                ],
                "type": "SubQuery"
            },
            {
                "type": "SubQuery",
                "fragments": [
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opId": 0,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 1
                            },
                            {
                                "argAggFields": [
                                    5
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_MAX"
                                    ]
                                ],
                                "argChild": 0,
                                "opId": 2,
                                "opName": "MyriaGroupBy($0,$1,$2,$3,$4; MAX($5))",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1,
                                    2,
                                    3,
                                    4
                                ]
                            },
                            {
                                "opId": 3,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "halo",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "totalParticleCount",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "prog",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    }
                                ],
                                "argChild": 2,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,halo=$1,timestep=$2,mass=$3,totalParticleCount=$4,prog=$5)"
                            },
                            {
                                "relationKey": {
                                    "relationName": "haloTable",
                                    "programName": "mergerTreeTerabyte",
                                    "userName": "astro"
                                },
                                "opId": 4,
                                "argChild": 3,
                                "argOverwriteTable": true,
                                "opName": "MyriaStore(astro:mergerTreeTerabyte:haloTableTest)",
                                "opType": "DbInsert"
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opId": 5,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 6
                            },
                            {
                                "opId": 7,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 8
                            },
                            {
                                "argSelect1": [
                                    0,
                                    1,
                                    2,
                                    3,
                                    4
                                ],
                                "argSelect2": [],
                                "argColumns1": [
                                    2,
                                    1,
                                    0
                                ],
                                "argColumns2": [
                                    1,
                                    2,
                                    0
                                ],
                                "opId": 9,
                                "argColumnNames": [
                                    "nowGroup",
                                    "grp",
                                    "timestep",
                                    "mass",
                                    "totalParticleCount"
                                ],
                                "opName": "MyriaSymmetricHashJoin(((($2 = $6) and ($1 = $7)) and ($0 = $5)); [$0, $1, $2, $3, $4])",
                                "opType": "SymmetricHashJoin",
                                "argChild1": "7",
                                "argChild2": "5"
                            },
                            {
                                "opId": 10,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "totalParticleCount",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "prog",
                                        "rootExpressionOperator": {
                                            "type": "CONSTANT",
                                            "value": "1",
                                            "valueType": "INT_TYPE"
                                        }
                                    }
                                ],
                                "argChild": 9,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,grp=$1,timestep=$2,mass=$3,totalParticleCount=$4,prog=1)"
                            },
                            {
                                "opId": 11,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 12
                            },
                            {
                                "argAggFields": [
                                    4,
                                    5
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_SUM"
                                    ],
                                    [
                                        "AGG_OP_SUM"
                                    ]
                                ],
                                "argChild": 11,
                                "opId": 13,
                                "opName": "MyriaGroupBy($0,$1,$2,$3; SUM($4),SUM($5))",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1,
                                    2,
                                    3
                                ]
                            },
                            {
                                "opId": 14,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "totalParticleCount",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    },
                                    {
                                        "outputName": "prog",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    }
                                ],
                                "argChild": 13,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,grp=$1,timestep=$2,mass=$4,totalParticleCount=$5,prog=$3)"
                            },
                            {
                                "opId": 15,
                                "opName": "MyriaUnionAll",
                                "opType": "UnionAll",
                                "argChildren": [
                                    14,
                                    10
                                ]
                            },
                            {
                                "opId": 16,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "totalParticleCount",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "prog",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    },
                                    {
                                        "outputName": "_COLUMN5_",
                                        "rootExpressionOperator": {
                                            "type": "PLUS",
                                            "left": {
                                                "type": "TIMES",
                                                "left": {
                                                    "type": "PLUS",
                                                    "left": {
                                                        "type": "CONSTANT",
                                                        "value": "100",
                                                        "valueType": "INT_TYPE"
                                                    },
                                                    "right": {
                                                        "type": "VARIABLE",
                                                        "columnIdx": 2
                                                    }
                                                },
                                                "right": {
                                                    "type": "CONSTANT",
                                                    "value": "10000000",
                                                    "valueType": "INT_TYPE"
                                                }
                                            },
                                            "right": {
                                                "type": "VARIABLE",
                                                "columnIdx": 1
                                            }
                                        }
                                    }
                                ],
                                "argChild": 15,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep=$2,mass=$3,totalParticleCount=$4,prog=$5,_COLUMN5_=(((100 + $2) * 10000) + $1))"
                            },
                            {
                                "argAggFields": [
                                    4
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_MAX"
                                    ]
                                ],
                                "argChild": 16,
                                "opId": 17,
                                "opName": "MyriaGroupBy($0,$5,$1,$2,$3; MAX($4))",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    5,
                                    1,
                                    2,
                                    3
                                ]
                            },
                            {
                                "opId": 1,
                                "opName": "MyriaShuffleProducer(h($0,$1,$2,$3,$4))",
                                "argChild": 17,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        0,
                                        1,
                                        2,
                                        3,
                                        4
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opId": 18,
                                "relationKey": {
                                    "relationName": "allTimestepsUnion",
                                    "programName": "mergerTreeTerabyte",
                                    "userName": "astro"
                                },
                                "opName": "MyriaScan(astro:mergerTreeTerabyte:allTimestepsPOI)",
                                "opType": "TableScan"
                            },
                            {
                                "opId": 19,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    },
                                    {
                                        "outputName": "_COLUMN4_",
                                        "rootExpressionOperator": {
                                            "type": "CONSTANT",
                                            "value": "0",
                                            "valueType": "INT_TYPE"
                                        }
                                    }
                                ],
                                "argChild": 18,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,mass=$2,timestep=$4,grp=$5,_COLUMN4_=0)"
                            },
                            {
                                "argAggFields": [
                                    1,
                                    0
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_SUM"
                                    ],
                                    [
                                        "AGG_OP_COUNT"
                                    ]
                                ],
                                "argChild": 19,
                                "opId": 20,
                                "opName": "MyriaGroupBy($0,$3,$2,$4; SUM($1),COUNTALL)",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    3,
                                    2,
                                    4
                                ]
                            },
                            {
                                "opId": 12,
                                "opName": "MyriaShuffleProducer(h($0,$1,$2,$3))",
                                "argChild": 20,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        0,
                                        1,
                                        2,
                                        3
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opId": 21,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 22
                            },
                            {
                                "argAggFields": [
                                    4,
                                    5
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_SUM"
                                    ],
                                    [
                                        "AGG_OP_SUM"
                                    ]
                                ],
                                "argChild": 21,
                                "opId": 23,
                                "opName": "MyriaGroupBy($0,$1,$2,$3; SUM($4),SUM($5))",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1,
                                    2,
                                    3
                                ]
                            },
                            {
                                "opId": 24,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "totalParticleCount",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    }
                                ],
                                "argChild": 23,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,grp=$1,timestep=$2,mass=$4,totalParticleCount=$5)"
                            },
                            {
                                "opId": 8,
                                "opName": "MyriaShuffleProducer(h($2,$1,$0))",
                                "argChild": 24,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        2,
                                        1,
                                        0
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opId": 25,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 26
                            },
                            {
                                "opId": 27,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 28
                            },
                            {
                                "argSelect1": [
                                    0,
                                    1,
                                    2
                                ],
                                "argSelect2": [],
                                "argColumns1": [
                                    1,
                                    0,
                                    3
                                ],
                                "argColumns2": [
                                    1,
                                    0,
                                    2
                                ],
                                "opId": 29,
                                "argColumnNames": [
                                    "nowGroup",
                                    "timestep",
                                    "grp"
                                ],
                                "opName": "MyriaSymmetricHashJoin(((($1 = $5) and ($0 = $4)) and ($3 = $6)); [$0, $1, $2])",
                                "opType": "SymmetricHashJoin",
                                "argChild1": "27",
                                "argChild2": "25"
                            },
                            {
                                "opId": 30,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    }
                                ],
                                "argChild": 29,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep=$1,grp=$2)"
                            },
                            {
                                "opId": 6,
                                "opName": "MyriaShuffleProducer(h($1,$2,$0))",
                                "argChild": 30,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        1,
                                        2,
                                        0
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opId": 31,
                                "relationKey": {
                                    "relationName": "allTimestepsUnion",
                                    "programName": "mergerTreeTerabyte",
                                    "userName": "astro"
                                },
                                "opName": "MyriaScan(astro:mergerTreeTerabyte:timestepsPOITest)",
                                "opType": "TableScan"
                            },
                            {
                                "opId": 32,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    },
                                    {
                                        "outputName": "_COLUMN4_",
                                        "rootExpressionOperator": {
                                            "type": "CONSTANT",
                                            "value": "0",
                                            "valueType": "INT_TYPE"
                                        }
                                    }
                                ],
                                "argChild": 31,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,mass=$2,timestep=$4,grp=$5,_COLUMN4_=0)"
                            },
                            {
                                "argAggFields": [
                                    1,
                                    0
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_SUM"
                                    ],
                                    [
                                        "AGG_OP_COUNT"
                                    ]
                                ],
                                "argChild": 32,
                                "opId": 33,
                                "opName": "MyriaGroupBy($0,$3,$2,$4; SUM($1),COUNTALL)",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    3,
                                    2,
                                    4
                                ]
                            },
                            {
                                "opId": 22,
                                "opName": "MyriaShuffleProducer(h($0,$1,$2,$3))",
                                "argChild": 33,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        0,
                                        1,
                                        2,
                                        3
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opId": 34,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 35
                            },
                            {
                                "argAggFields": [
                                    3
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_SUM"
                                    ]
                                ],
                                "argChild": 34,
                                "opId": 36,
                                "opName": "MyriaGroupBy($0,$1,$2; SUM($3))",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1,
                                    2
                                ]
                            },
                            {
                                "opId": 37,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "numShared",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    }
                                ],
                                "argChild": 36,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep=$1,grp=$2,numShared=$3)"
                            },
                            {
                                "opId": 28,
                                "opName": "MyriaShuffleProducer(h($1,$0,$3))",
                                "argChild": 37,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        1,
                                        0,
                                        3
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opId": 38,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 39
                            },
                            {
                                "argAggFields": [
                                    2
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_MAX"
                                    ]
                                ],
                                "argChild": 38,
                                "opId": 40,
                                "opName": "MyriaGroupBy($0,$1; MAX($2))",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1
                                ]
                            },
                            {
                                "opId": 41,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "maxShared",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    }
                                ],
                                "argChild": 40,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep=$1,maxShared=$2)"
                            },
                            {
                                "opId": 26,
                                "opName": "MyriaShuffleProducer(h($1,$0,$2))",
                                "argChild": 41,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        1,
                                        0,
                                        2
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opId": 42,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 43
                            },
                            {
                                "opId": 44,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 45
                            },
                            {
                                "argSelect1": [
                                    0
                                ],
                                "argSelect2": [
                                    1,
                                    2
                                ],
                                "argColumns1": [
                                    1
                                ],
                                "argColumns2": [
                                    0
                                ],
                                "opId": 46,
                                "argColumnNames": [
                                    "nowGroup",
                                    "timestep",
                                    "grp"
                                ],
                                "opName": "MyriaSymmetricHashJoin(($1 = $2); [$0, $3, $4])",
                                "opType": "SymmetricHashJoin",
                                "argChild1": "44",
                                "argChild2": "42"
                            },
                            {
                                "opId": 47,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep1",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "grp1",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    }
                                ],
                                "argChild": 46,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep1=$1,grp1=$2)"
                            },
                            {
                                "argAggFields": [
                                    0
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_COUNT"
                                    ]
                                ],
                                "argChild": 47,
                                "opId": 48,
                                "opName": "MyriaGroupBy($0,$1,$2; COUNTALL)",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1,
                                    2
                                ]
                            },
                            {
                                "opId": 35,
                                "opName": "MyriaShuffleProducer(h($0,$1,$2))",
                                "argChild": 48,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        0,
                                        1,
                                        2
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opId": 49,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 50
                            },
                            {
                                "argAggFields": [
                                    3
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_SUM"
                                    ]
                                ],
                                "argChild": 49,
                                "opId": 51,
                                "opName": "MyriaGroupBy($0,$1,$2; SUM($3))",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1,
                                    2
                                ]
                            },
                            {
                                "opId": 52,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "numShared",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    }
                                ],
                                "argChild": 51,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep=$1,numShared=$3)"
                            },
                            {
                                "argAggFields": [
                                    2
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_MAX"
                                    ]
                                ],
                                "argChild": 52,
                                "opId": 53,
                                "opName": "MyriaGroupBy($0,$1; MAX($2))",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1
                                ]
                            },
                            {
                                "opId": 39,
                                "opName": "MyriaShuffleProducer(h($0,$1))",
                                "argChild": 53,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        0,
                                        1
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opId": 54,
                                "relationKey": {
                                    "relationName": "allTimestepsUnion",
                                    "programName": "mergerTreeTerabyte",
                                    "userName": "astro"
                                },
                                "opName": "MyriaScan(astro:mergerTreeTerabyte:allTimestepsPOI)",
                                "opType": "TableScan"
                            },
                            {
                                "opId": 55,
                                "opName": "MyriaSelect(($4 = 1))",
                                "argChild": 54,
                                "opType": "Filter",
                                "argPredicate": {
                                    "rootExpressionOperator": {
                                        "type": "EQ",
                                        "left": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        },
                                        "right": {
                                            "type": "CONSTANT",
                                            "value": "1",
                                            "valueType": "INT_TYPE"
                                        }
                                    }
                                }
                            },
                            {
                                "opId": 56,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "iOrder",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    }
                                ],
                                "argChild": 55,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,iOrder=$1)"
                            },
                            {
                                "opId": 45,
                                "opName": "MyriaShuffleProducer(h($1))",
                                "argChild": 56,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "index": 1,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opId": 57,
                                "relationKey": {
                                    "relationName": "allTimestepsUnion",
                                    "programName": "mergerTreeTerabyte",
                                    "userName": "astro"
                                },
                                "opName": "MyriaScan(astro:mergerTreeTerabyte:allTimestepsPOI)",
                                "opType": "TableScan"
                            },
                            {
                                "opId": 58,
                                "emitExpressions": [
                                    {
                                        "outputName": "iOrder",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    }
                                ],
                                "argChild": 57,
                                "opType": "Apply",
                                "opName": "MyriaApply(iOrder=$1,timestep=$4,grp=$5)"
                            },
                            {
                                "opId": 43,
                                "opName": "MyriaShuffleProducer(h($0))",
                                "argChild": 58,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "index": 0,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opId": 59,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 60
                            },
                            {
                                "opId": 61,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 62
                            },
                            {
                                "argSelect1": [
                                    0
                                ],
                                "argSelect2": [
                                    1,
                                    2
                                ],
                                "argColumns1": [
                                    1
                                ],
                                "argColumns2": [
                                    0
                                ],
                                "opId": 63,
                                "argColumnNames": [
                                    "nowGroup",
                                    "timestep",
                                    "grp"
                                ],
                                "opName": "MyriaSymmetricHashJoin(($1 = $2); [$0, $3, $4])",
                                "opType": "SymmetricHashJoin",
                                "argChild1": "61",
                                "argChild2": "59"
                            },
                            {
                                "opId": 64,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep1",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "grp1",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    }
                                ],
                                "argChild": 63,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep1=$1,grp1=$2)"
                            },
                            {
                                "argAggFields": [
                                    0
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_COUNT"
                                    ]
                                ],
                                "argChild": 64,
                                "opId": 65,
                                "opName": "MyriaGroupBy($0,$1,$2; COUNTALL)",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1,
                                    2
                                ]
                            },
                            {
                                "opId": 50,
                                "opName": "MyriaShuffleProducer(h($0,$1,$2))",
                                "argChild": 65,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        0,
                                        1,
                                        2
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opId": 66,
                                "relationKey": {
                                    "relationName": "allTimestepsUnion",
                                    "programName": "mergerTreeTerabyte",
                                    "userName": "astro"
                                },
                                "opName": "MyriaScan(astro:mergerTreeTerabyte:allTimestepsPOI)",
                                "opType": "TableScan"
                            },
                            {
                                "opId": 67,
                                "opName": "MyriaSelect(($4 = 1))",
                                "argChild": 66,
                                "opType": "Filter",
                                "argPredicate": {
                                    "rootExpressionOperator": {
                                        "type": "EQ",
                                        "left": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        },
                                        "right": {
                                            "type": "CONSTANT",
                                            "value": "1",
                                            "valueType": "INT_TYPE"
                                        }
                                    }
                                }
                            },
                            {
                                "opId": 68,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "iOrder",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    }
                                ],
                                "argChild": 67,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,iOrder=$1)"
                            },
                            {
                                "opId": 62,
                                "opName": "MyriaShuffleProducer(h($1))",
                                "argChild": 68,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "index": 1,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opId": 69,
                                "relationKey": {
                                    "relationName": "allTimestepsUnion",
                                    "programName": "mergerTreeTerabyte",
                                    "userName": "astro"
                                },
                                "opName": "MyriaScan(astro:mergerTreeTerabyte:allTimestepsPOI)",
                                "opType": "TableScan"
                            },
                            {
                                "opId": 70,
                                "emitExpressions": [
                                    {
                                        "outputName": "iOrder",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    }
                                ],
                                "argChild": 69,
                                "opType": "Apply",
                                "opName": "MyriaApply(iOrder=$1,timestep=$4,grp=$5)"
                            },
                            {
                                "opId": 60,
                                "opName": "MyriaShuffleProducer(h($0))",
                                "argChild": 70,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "index": 0,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    }
                ]
            },
            {
                "fragments": [
                    {
                         "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opType": "ShuffleConsumer",
                                "opName": "MyriaShuffleConsumer",
                                "argOperatorId": 1,
                                "opId": 0
                            },
                            {
                                "opType": "DupElim",
                                "argChild": 0,
                                "opId": 2,
                                "opName": "MyriaDupElim"
                            },
                            {
                                "relationKey": {
                                    "userName": "astro",
                                    "programName": "mergerTreeTerabyte",
                                    "relationName": "haloTableFilter"
                                },
                                "opType": "DbInsert",
                                "opName": "MyriaStore(jortiz:testAstro:haloTableFilter)",
                                "opId": 3,
                                "argChild": 2,
                                "argOverwriteTable": true
                            }
                        ]
                    },
                    {
                         "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opType": "BroadcastConsumer",
                                "opName": "MyriaBroadcastConsumer",
                                "argOperatorId": 5,
                                "opId": 4
                            },
                            {
                                "opType": "TableScan",
                                "opName": "MyriaScan(jortiz:astroTest:DistinctFinalChain)",
                                "opId": 6,
                                "relationKey": {
                                    "userName": "astro",
                                    "programName": "mergerTreeTerabyte",
                                    "relationName": "DistinctFinalChain"
                                }
                            },
                            {
                                "opType": "SymmetricHashJoin",
                                "argChild2": 4,
                                "argChild1": 6,
                                "opName": "MyriaCrossProduct",
                                "opId": 7,
                                "argColumnNames": [
                                    "nowGroup",
                                    "timestep",
                                    "currentHalo",
                                    "nextHalo",
                                    "sharedParticleCount",
                                    "nowGroup1",
                                    "halo",
                                    "timestep1",
                                    "mass",
                                    "totalParticleCount",
                                    "prog"
                                ],
                                "argColumns1": [],
                                "argColumns2": [],
                                "argSelect2": [
                                    0,
                                    1,
                                    2,
                                    3,
                                    4,
                                    5
                                ],
                                "argSelect1": [
                                    0,
                                    1,
                                    2,
                                    3,
                                    4
                                ]
                            },
                            {
                                "opType": "Filter",
                                "argChild": 7,
                                "argPredicate": {
                                    "rootExpressionOperator": {
                                        "left": {
                                            "left": {
                                                "columnIdx": 3,
                                                "type": "VARIABLE"
                                            },
                                            "right": {
                                                "columnIdx": 6,
                                                "type": "VARIABLE"
                                            },
                                            "type": "EQ"
                                        },
                                        "right": {
                                            "left": {
                                                "columnIdx": 2,
                                                "type": "VARIABLE"
                                            },
                                            "right": {
                                                "columnIdx": 6,
                                                "type": "VARIABLE"
                                            },
                                            "type": "EQ"
                                        },
                                        "type": "OR"
                                    }
                                },
                                "opId": 8,
                                "opName": "MyriaSelect((($3 = $6) or ($2 = $6)))"
                            },
                            {
                                "opType": "Apply",
                                "argChild": 8,
                                "emitExpressions": [
                                    {
                                        "rootExpressionOperator": {
                                            "columnIdx": 5,
                                            "type": "VARIABLE"
                                        },
                                        "outputName": "nowGroup"
                                    },
                                    {
                                        "rootExpressionOperator": {
                                            "columnIdx": 6,
                                            "type": "VARIABLE"
                                        },
                                        "outputName": "halo"
                                    },
                                    {
                                        "rootExpressionOperator": {
                                            "columnIdx": 7,
                                            "type": "VARIABLE"
                                        },
                                        "outputName": "timestep"
                                    },
                                    {
                                        "rootExpressionOperator": {
                                            "columnIdx": 8,
                                            "type": "VARIABLE"
                                        },
                                        "outputName": "mass"
                                    },
                                    {
                                        "rootExpressionOperator": {
                                            "columnIdx": 9,
                                            "type": "VARIABLE"
                                        },
                                        "outputName": "totalParticleCount"
                                    },
                                    {
                                        "rootExpressionOperator": {
                                            "columnIdx": 10,
                                            "type": "VARIABLE"
                                        },
                                        "outputName": "prog"
                                    }
                                ],
                                "opId": 9,
                                "opName": "MyriaApply(nowGroup=$5,halo=$6,timestep=$7,mass=$8,totalParticleCount=$9,prog=$10)"
                            },
                            {
                                "opType": "ShuffleProducer",
                                "argChild": 9,
                                "argPf": {
                                    "indexes": [
                                        0,
                                        1,
                                        2,
                                        3,
                                        4,
                                        5
                                    ],
                                    "type": "MultiFieldHash"
                                },
                                "opId": 1,
                                "opName": "MyriaShuffleProducer(h($0,$1,$2,$3,$4,$5))"
                            }
                        ]
                    },
                    {
                         "workers": [
                            7,
                            8,
                            9,
                            10
                        ],
                        "operators": [
                            {
                                "opType": "TableScan",
                                "opName": "MyriaScan(jortiz:testAstro:haloTableTest)",
                                "opId": 10,
                                "relationKey": {
                                    "userName": "astro",
                                    "programName": "mergerTreeTerabyte",
                                    "relationName": "haloTable"
                                }
                            },
                            {
                                "opType": "BroadcastProducer",
                                "argChild": 10,
                                "opId": 5,
                                "opName": "MyriaBroadcastProducer"
                            }
                        ]
                    }
                ],
                "type": "SubQuery"
            }

        ]
    },
    "rawQuery": "scriptfor10TimestepsTerabyteDatasetTested"
}